<link rel="import" href="../../../node_modules/@polymer/polymer/polymer.html">

<link rel="import" href="../../../node_modules/scram-express/express-middleware.html">
<link rel="import" href="../../../node_modules/scram-express/express-router.html">

<link rel="import" href="../monkey/example-monkey.html">
<link rel="import" href="../lion/example-lion.html">
<link rel="import" href="../bear/example-bear.html">

<dom-module id="example-api">
    <template>
        <express-middleware method="get" path="/monkey" callback="[[test]]"></express-middleware>
        <!--<express-router path="/monkey">
            <example-monkey></example-monkey>
        </express-router>

        <express-router path="/lion">
            <example-lion></example-lion>
        </express-router>

        <express-router path="/bear">
            <example-bear></example-bear>
        </express-router>-->
    </template>

    <script>
        class ExampleApiComponent {
            beforeRegister() {
                this.is = 'example-api';
                this.properties = {
                    app: { //set by the parent element imperatively
                        type: Object,
                        notify: 'init'
                    },
                    router: { //set by the parent element imperatively
                        type: Object,
                        notify: 'init'
                    }
                };
            }

            ready() {}
            attached() {}
            detached() {}
            attributeChanged() {}

            init() {
                console.log('example-api init');
                const children = Array.prototype.slice.call(this.childNodes);
                children.forEach((child) => {
                    !child.app && (child.app = this.app);
                    !child.router && (child.router = router);
                });
            }

            test(req, res) {
                res.send('test works');
            }
        }
        Polymer(ExampleApiComponent);
    </script>
</dom-module>
